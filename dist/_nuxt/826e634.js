(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{337:function(t,e,n){"use strict";function r(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function o(element){let rect=element.getBoundingClientRect();return{top:rect.top+(document.documentElement.scrollTop||document.body.scrollTop),left:rect.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}n.d(e,"a",(function(){return zt})),r.create=(t,e)=>{var element=document.createElement(t);for(var i in e){var n=e[i];if("inside"===i)r(n).appendChild(element);else if("around"===i){var o=r(n);o.parentNode.insertBefore(element,o),element.appendChild(o)}else"styles"===i?"object"==typeof n&&Object.keys(n).map((t=>{element.style[t]=n[t]})):i in element?element[i]=n:element.setAttribute(i,n)}return element};const l={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function h(t){return t.titleHeight+t.margins.top+t.paddings.top}function d(t){return t.margins.left+t.paddings.left}function c(t){return t.margins.top+t.margins.bottom+t.paddings.top+t.paddings.bottom+t.titleHeight+t.legendHeight}function m(t){return t.margins.left+t.margins.right+t.paddings.left+t.paddings.right}const f=["line","bar"],y=10,x=["light-blue","blue","violet","red","orange","yellow","green","light-green","purple","magenta","light-grey","dark-grey"],v={bar:x,line:x,pie:x,percentage:x,heatmap:["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],donut:x},w=Math.PI/180;class A{constructor({parent:t=null,colors:e=[]}){this.parent=t,this.colors=e,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}setup(){this.makeTooltip()}refresh(){this.fill(),this.calcPosition()}makeTooltip(){this.container=r.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:'<span class="title"></span>\n\t\t\t\t<ul class="data-point-list"></ul>\n\t\t\t\t<div class="svg-pointer"></div>'}),this.hideTip(),this.title=this.container.querySelector(".title"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",(()=>{this.hideTip()}))}fill(){let title;this.index&&this.container.setAttribute("data-point-index",this.index),title=this.titleValueFirst?`<strong>${this.titleValue}</strong>${this.titleName}`:`${this.titleName}<strong>${this.titleValue}</strong>`,this.title.innerHTML=title,this.dataPointList.innerHTML="",this.listValues.map(((t,i)=>{const e=this.colors[i]||"black";let n=0===t.formatted||t.formatted?t.formatted:t.value,li=r.create("li",{styles:{"border-top":`3px solid ${e}`},innerHTML:`<strong style="display: block;">${0===n||n?n:""}</strong>\n\t\t\t\t\t${t.title?t.title:""}`});this.dataPointList.appendChild(li)}))}calcPosition(){let t=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-5,this.left=this.x-t/2;let e=this.parent.offsetWidth-t,n=this.container.querySelector(".svg-pointer");if(this.left<0)n.style.left=`calc(50% - ${-1*this.left}px)`,this.left=0;else if(this.left>e){let t=`calc(50% + ${this.left-e}px)`;n.style.left=t,this.left=e}else n.style.left="50%"}setValues(t,e,title={},n=[],r=-1){this.titleName=title.name,this.titleValue=title.value,this.listValues=n,this.x=t,this.y=e,this.titleValueFirst=title.valueFirst||0,this.index=r,this.refresh()}hideTip(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}showTip(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}function k(t){return parseFloat(t.toFixed(2))}function L(t,e,element,n=!1){element||(element=n?t[0]:t[t.length-1]);let r=new Array(Math.abs(e)).fill(element);return t=n?r.concat(t):t.concat(r)}function T(t,e){return(t+"").length*e}function M(t,e){return{x:Math.sin(t*w)*e,y:Math.cos(t*w)*e}}function P(t,e=!1){return!Number.isNaN(t)&&(void 0!==t&&(!!Number.isFinite(t)&&!(e&&t<0)))}function D(t){let e,n,r;if(t instanceof Date)return new Date(t.getTime());if("object"!=typeof t||null===t)return t;for(r in e=Array.isArray(t)?[]:{},t)n=t[r],e[r]=D(n);return e}function C(t,e){let n,r;return t<=e?(n=e-t,r=t):(n=t-e,r=e),[n,r]}function $(t,e,n=e.length-t.length){return n>0?t=L(t,n):e=L(e,n),[t,e]}function N(t,e){if(t)return t.length>e?t.slice(0,e-3)+"...":t}function S(t,e){let n=[];for(let i=0;i<t.length;i++)n.push([t[i],e[i]]);let r=(t,e,n,r)=>{let o=((t,e)=>{let n=e[0]-t[0],r=e[1]-t[1];return{length:Math.sqrt(Math.pow(n,2)+Math.pow(r,2)),angle:Math.atan2(r,n)}})(e||t,n||t),l=o.angle+(r?Math.PI:0),h=.2*o.length;return[t[0]+Math.cos(l)*h,t[1]+Math.sin(l)*h]};return((t,e)=>t.reduce(((t,n,i,a)=>0===i?`${n[0]},${n[1]}`:`${t} ${e(n,i,a)}`),""))(n,((t,i,a)=>{let e=r(a[i-1],a[i-2],t),n=r(t,a[i-1],a[i+1],!0);return`C ${e[0]},${e[1]} ${n[0]},${n[1]} ${t[0]},${t[1]}`}))}const O={"light-blue":"#7cd6fd",blue:"#5e64ff",violet:"#743ee2",red:"#ff5858",orange:"#ffa00a",yellow:"#feef72",green:"#28a745","light-green":"#98d85b",purple:"#b554ff",magenta:"#ffa3ef",black:"#36114C",grey:"#bdd3e6","light-grey":"#f0f4f7","dark-grey":"#b8c2cc"};function E(t){return t>255?255:t<0?0:t}function z(t,e){let col=W(t),n=!1;"#"==col[0]&&(col=col.slice(1),n=!0);let r=parseInt(col,16),o=E((r>>16)+e),b=E((r>>8&255)+e);return(n?"#":"")+(E((255&r)+e)|b<<8|o<<16).toString(16)}const W=t=>/rgb[a]{0,1}\([\d, ]+\)/gim.test(t)?/\D+(\d*)\D+(\d*)\D+(\d*)/gim.exec(t).map(((t,i)=>0!==i?Number(t).toString(16):"#")).reduce(((t,e)=>`${t}${e}`)):O[t]||t,H=10,F="#dadada",R="#555b51";function Y(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function I(t,e){var element=document.createElementNS("http://www.w3.org/2000/svg",t);for(var i in e){var n=e[i];if("inside"===i)Y(n).appendChild(element);else if("around"===i){var r=Y(n);r.parentNode.insertBefore(element,r),element.appendChild(r)}else"styles"===i?"object"==typeof n&&Object.keys(n).map((t=>{element.style[t]=n[t]})):("className"===i&&(i="class"),"innerHTML"===i?element.textContent=n:element.setAttribute(i,n))}return element}function V(t,e,n,r){return I("stop",{inside:t,style:`stop-color: ${n}`,offset:e,"stop-opacity":r})}function j(t,e="",n){let r={className:t,transform:e};return n&&(r.inside=n),I("g",r)}function B(t,e="",n="none",r="none",o=2){return I("path",{className:e,d:t,styles:{stroke:n,fill:r,"stroke-width":o}})}function U(t,e,n=!1){let r="path-fill-gradient-"+e+"-"+(n?"lighter":"default"),o=function(t,e){return I("linearGradient",{inside:t,id:e,x1:0,x2:0,y1:0,y2:1})}(t,r),l=[1,.6,.2];return n&&(l=[.4,.2,0]),V(o,"0%",e,l[0]),V(o,"50%",e,l[1]),V(o,"100%",e,l[2]),r}function G(t,e,n,r,o,l="none",data={}){let h={className:t,x:e,y:n,width:r,height:r,rx:o,fill:l};return Object.keys(data).map((t=>{h[t]=data[t]})),I("rect",h)}function X(t,e,n,content,r={}){let o=r.fontSize||H;return I("text",{className:t,x:e,y:n,dy:(void 0!==r.dy?r.dy:o/2)+"px","font-size":o+"px",fill:r.fill||R,"text-anchor":r.textAnchor||"start",innerHTML:content})}function _(t,label,e,n,r={}){r.stroke||(r.stroke=F),r.lineType||(r.lineType=""),r.shortenNumbers&&(label=function(label){let t;if("number"==typeof label)t=label;else if("string"==typeof label&&(t=Number(label),Number.isNaN(t)))return label;let p=Math.floor(Math.log10(Math.abs(t)));if(p<=2)return t;let e=Math.floor(p/3),n=Math.pow(10,p-3*e)*+(t/Math.pow(10,p)).toFixed(1);return Math.round(100*n)/100+" "+["","K","M","B","T"][e]}(label));let o=I("line",{className:"line-horizontal "+r.className+("dashed"===r.lineType?"dashed":""),x1:e,x2:n,y1:0,y2:0,styles:{stroke:r.stroke}}),text=I("text",{x:e<n?e-4:e+4,y:0,dy:"3px","font-size":"10px","text-anchor":e<n?"end":"start",innerHTML:label+""}),line=I("g",{transform:`translate(0, ${t})`,"stroke-opacity":1});return 0!==text&&"0"!==text||(line.style.stroke="rgba(27, 31, 35, 0.6)"),line.appendChild(o),line.appendChild(text),line}function J(t,label,e,n={}){P(t)||(t=0),n.pos||(n.pos="bottom"),n.offset||(n.offset=0),n.mode||(n.mode="span"),n.stroke||(n.stroke=F),n.className||(n.className="");let r=e+6,o="span"===n.mode?-6:e;return"tick"===n.mode&&"top"===n.pos&&(r=-6,o=0),function(t,label,e,n,r={}){r.stroke||(r.stroke=F);let o=I("line",{className:"line-vertical "+r.className,x1:0,x2:0,y1:e,y2:n,styles:{stroke:r.stroke}}),text=I("text",{x:0,y:e>n?e+4:e-4-H,dy:"10px","font-size":"10px","text-anchor":"middle",innerHTML:label+""}),line=I("g",{transform:`translate(${t}, 0)`});return line.appendChild(o),line.appendChild(text),line}(t,label,r,o,{stroke:n.stroke,className:n.className,lineType:n.lineType})}let K={bar:t=>{let e;"rect"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);let n=t.cloneNode();return n.style.fill="#000000",n.style.opacity="0.4",e&&n.setAttribute("transform",e),n},dot:t=>{let e;"circle"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);let n=t.cloneNode(),r=t.getAttribute("r"),o=t.getAttribute("fill");return n.setAttribute("r",parseInt(r)+4),n.setAttribute("fill",o),n.style.opacity="0.6",e&&n.setAttribute("transform",e),n},heat_square:t=>{let e;"circle"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);let n=t.cloneNode(),r=t.getAttribute("r"),o=t.getAttribute("fill");return n.setAttribute("r",parseInt(r)+4),n.setAttribute("fill",o),n.style.opacity="0.6",e&&n.setAttribute("transform",e),n}},Q={bar:(t,e)=>{let n;"rect"!==t.nodeName&&(n=t.getAttribute("transform"),t=t.childNodes[0]);let r=["x","y","width","height"];Object.values(t.attributes).filter((t=>r.includes(t.name)&&t.specified)).map((t=>{e.setAttribute(t.name,t.nodeValue)})),n&&e.setAttribute("transform",n)},dot:(t,e)=>{let n;"circle"!==t.nodeName&&(n=t.getAttribute("transform"),t=t.childNodes[0]);let r=["cx","cy"];Object.values(t.attributes).filter((t=>r.includes(t.name)&&t.specified)).map((t=>{e.setAttribute(t.name,t.nodeValue)})),n&&e.setAttribute("transform",n)},heat_square:(t,e)=>{let n;"circle"!==t.nodeName&&(n=t.getAttribute("transform"),t=t.childNodes[0]);let r=["cx","cy"];Object.values(t.attributes).filter((t=>r.includes(t.name)&&t.specified)).map((t=>{e.setAttribute(t.name,t.nodeValue)})),n&&e.setAttribute("transform",n)}};const Z=350,tt=Z,et="easein";function st(t,e,n,r){let o="string"==typeof e?e:e.join(", ");return[t,{transform:n.join(", ")},r,et,"translate",{transform:o}]}function it(t,e,n){return st(t,[0,n],[0,e],tt)}function at(t,e){return[t,{d:e},Z,et]}const nt={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function ot(element,style){element.style.transform=style,element.style.webkitTransform=style,element.style.msTransform=style,element.style.mozTransform=style,element.style.oTransform=style}function lt(t,e){let n=[],r=[];e.map((element=>{let t,e,o=element[0],l=o.parentNode;element[0]=o,[t,e]=function(element,t,e,n="linear",r,o={}){let l=element.cloneNode(!0),h=element.cloneNode(!0);for(var d in t){let c;c="transform"===d?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");let m=o[d]||element.getAttribute(d),f=t[d],y={attributeName:d,from:m,to:f,begin:"0s",dur:e/1e3+"s",values:m+";"+f,keySplines:nt[n],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var i in r&&(y.type=r),y)c.setAttribute(i,y[i]);l.appendChild(c),r?h.setAttribute(d,`translate(${f})`):h.setAttribute(d,f)}return[l,h]}(...element),n.push(e),r.push([t,l]),l&&l.replaceChild(t,o)}));let o=t.cloneNode(!0);return r.map(((t,i)=>{t[1]&&(t[1].replaceChild(n[i],t[0]),e[i][0]=n[i])})),o}class ht{constructor(t,e){if(e=D(e),this.parent="string"==typeof t?document.querySelector(t):t,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=e,this.title=e.title||"",this.type=e.type||"",this.realData=this.prepareData(e.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(e.colors,this.type),this.config={showTooltip:1,showLegend:1,isNavigable:e.isNavigable||0,animate:void 0!==e.animate?e.animate:1,truncateLegends:e.truncateLegends||1},this.measures=JSON.parse(JSON.stringify(l));let n=this.measures;this.setMeasures(e),this.title.length||(n.titleHeight=0),this.config.showLegend||(n.legendHeight=0),this.argHeight=e.height||n.baseHeight,this.state={},this.options={},this.initTimeout=700,this.config.isNavigable&&(this.overlays=[]),this.configure(e)}prepareData(data){return data}prepareFirstData(data){return data}validateColors(t,e){const n=[];return(t=(t||[]).concat(v[e])).forEach((t=>{const e=W(t);!function(t){return/(^\s*)(#)((?:[A-Fa-f0-9]{3}){1,2})$/i.test(t)||/(^\s*)(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/i.test(t)}(e)?console.warn('"'+t+'" is not a valid color.'):n.push(e)})),n}setMeasures(){}configure(){let t=this.argHeight;this.baseHeight=t,this.height=t-c(this.measures),this.boundDrawFn=()=>this.draw(!0),ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.boundDrawFn),this.resizeObserver.observe(this.parent)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}setup(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}makeContainer(){this.parent.innerHTML="";let t={inside:this.parent,className:"chart-container"};this.independentWidth&&(t.styles={width:this.independentWidth+"px"}),this.container=r.create("div",t)}makeTooltip(){this.tip=new A({parent:this.container,colors:this.colors}),this.bindTooltip()}bindTooltip(){}draw(t=!1,e=!1){t&&null===this.parent.offsetParent||(this.updateWidth(),this.calc(t),this.makeChartArea(),this.setupComponents(),this.components.forEach((t=>t.setup(this.drawArea))),this.render(this.components,!1),e&&(this.data=this.realData,setTimeout((()=>{this.update(this.data)}),this.initTimeout)),this.renderLegend(),this.setupNavigation(e))}calc(){}updateWidth(){var element,t,e;this.baseWidth=(element=this.parent,t=window.getComputedStyle(element),e=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),element.clientWidth-e),this.width=this.baseWidth-m(this.measures)}makeChartArea(){this.svg&&this.container.removeChild(this.svg);let t=this.measures;var e,n,r,o;this.svg=(e=this.container,n="frappe-chart chart",r=this.baseWidth,o=this.baseHeight,I("svg",{className:n,inside:e,width:r,height:o})),this.svgDefs=I("defs",{inside:this.svg}),this.title.length&&(this.titleEL=X("title",t.margins.left,t.margins.top,this.title,{fontSize:t.titleFontSize,fill:"#666666",dy:t.titleFontSize}));let l=h(t);this.drawArea=j(this.type+"-chart chart-draw-area",`translate(${d(t)}, ${l})`),this.config.showLegend&&(l+=this.height+t.paddings.bottom,this.legendArea=j("chart-legend",`translate(${d(t)}, ${l})`)),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(d(t),h(t))}updateTipOffset(t,e){this.tip.offset={x:t,y:e}}setupComponents(){this.components=new Map}update(data){data||console.error("No data to update."),this.data=this.prepareData(data),this.calc(),this.render(this.components,this.config.animate),this.renderLegend()}render(t=this.components,animate=!0){this.config.isNavigable&&this.overlays.map((t=>t.parentNode.removeChild(t)));let e=[];t.forEach((t=>{e=e.concat(t.update(animate))})),e.length>0?(!function(t,e,n){if(0===n.length)return;let r=lt(e,n);e.parentNode==t&&(t.removeChild(e),t.appendChild(r)),setTimeout((()=>{r.parentNode==t&&(t.removeChild(r),t.appendChild(e))}),250)}(this.container,this.svg,e),setTimeout((()=>{t.forEach((t=>t.make())),this.updateNav()}),400)):(t.forEach((t=>t.make())),this.updateNav())}updateNav(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}renderLegend(){}setupNavigation(t=!1){this.config.isNavigable&&t&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",(t=>{var e,rect;e=this.container,(rect=e.getBoundingClientRect()).top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)&&(t=t||window.event,this.keyActions[t.keyCode]&&this.keyActions[t.keyCode]())})))}makeOverlay(){}updateOverlay(){}bindOverlay(){}bindUnits(){}onLeftArrow(){}onRightArrow(){}onUpArrow(){}onDownArrow(){}onEnterKey(){}addDataPoint(){}removeDataPoint(){}getDataPoint(){}setCurrentDataPoint(){}updateDataset(){}export(){let t=function(svg){let t=svg.cloneNode(!0);t.classList.add("chart-container"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");let e=r.create("style",{innerHTML:".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;border-top-color:rgba(0,0,0,.8)}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}"});t.insertBefore(e,t.firstChild);let n=r.create("div");return n.appendChild(t),n.innerHTML}(this.svg);!function(t,data){var a=document.createElement("a");a.style="display: none";var e=new Blob(data,{type:"image/svg+xml; charset=utf-8"}),n=window.URL.createObjectURL(e);a.href=n,a.download=t,document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(n)}),300)}(this.title||"Chart",[t])}}class ct extends ht{constructor(t,e){super(t,e)}configure(t){super.configure(t),this.config.formatTooltipY=(t.tooltipOptions||{}).formatTooltipY,this.config.maxSlices=t.maxSlices||20,this.config.maxLegendPoints=t.maxLegendPoints||20}calc(){let s=this.state,t=this.config.maxSlices;s.sliceTotals=[];let e=this.data.labels.map(((label,i)=>{let t=0;return this.data.datasets.map((e=>{t+=e.values[i]})),[t,label]})).filter((t=>t[0]>=0)),n=e;if(e.length>t){e.sort(((a,b)=>b[0]-a[0])),n=e.slice(0,t-1);let r=e.slice(t-1),o=0;r.map((t=>{o+=t[0]})),n.push([o,"Rest"]),this.colors[t-1]="grey"}s.labels=[],n.map((t=>{s.sliceTotals.push(function(t){return Number(Math.round(t+"e4")+"e-4")}(t[0])),s.labels.push(t[1])})),s.grandTotal=s.sliceTotals.reduce(((a,b)=>a+b),0),this.center={x:this.width/2,y:this.height/2}}renderLegend(){let s=this.state;this.legendArea.textContent="",this.legendTotals=s.sliceTotals.slice(0,this.config.maxLegendPoints);let t=0,e=0;this.legendTotals.map(((n,i)=>{let r=150,o=Math.floor((this.width-m(this.measures))/r);this.legendTotals.length<o&&(r=this.width/this.legendTotals.length),t>o&&(t=0,e+=20);let l=r*t+5,label=this.config.truncateLegends?N(s.labels[i],r/10):s.labels[i],h=this.config.formatTooltipY?this.config.formatTooltipY(n):n,d=function(t,e,n,r="none",label,o=!1){label=o?N(label,15):label;let l={className:"legend-dot",cx:0,cy:0,r:n,fill:r},text=I("text",{className:"legend-dataset-text",x:0,y:0,dx:"10px",dy:H/3+"px","font-size":"12px","text-anchor":"start",fill:R,innerHTML:label}),h=I("g",{transform:`translate(${t}, ${e})`});return h.appendChild(I("circle",l)),h.appendChild(text),h}(l,e,5,this.colors[i],`${label}: ${h}`,!1);this.legendArea.appendChild(d),t++}))}}const pt=1e3,ut=["January","February","March","April","May","June","July","August","September","October","November","December"],mt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function gt(t){let e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e}function ft(t){let dd=t.getDate(),e=t.getMonth()+1;return[t.getFullYear(),(e>9?"":"0")+e,(dd>9?"":"0")+dd].join("-")}function yt(t){return new Date(t.getTime())}function bt(t,e){let n=At(t);return Math.ceil(function(t,e){let n=864e5;return(gt(e)-gt(t))/n}(n,e)/7)}function xt(t,e){return t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function vt(i,t=!1){let e=ut[i];return t?e.slice(0,3):e}function wt(t,e){return new Date(e,t+1,0)}function At(t){let e=yt(t);const n=e.getDay();return 0!==n&&kt(e,-1*n),e}function kt(t,e){t.setDate(t.getDate()+e)}class Lt{constructor({layerClass:t="",layerTransform:e="",constants:n,getData:r,makeElements:o,animateElements:l}){this.layerTransform=e,this.constants=n,this.makeElements=o,this.getData=r,this.animateElements=l,this.store=[],this.labels=[],this.layerClass=t,this.layerClass="function"==typeof this.layerClass?this.layerClass():this.layerClass,this.refresh()}refresh(data){this.data=data||this.getData()}setup(t){this.layer=j(this.layerClass,this.layerTransform,t)}make(){this.render(this.data),this.oldData=this.data}render(data){this.store=this.makeElements(data),this.layer.textContent="",this.store.forEach((element=>{this.layer.appendChild(element)})),this.labels.forEach((element=>{this.layer.appendChild(element)}))}update(animate=!0){this.refresh();let t=[];return animate&&(t=this.animateElements(this.data)||[]),t}}let Tt={donutSlices:{layerClass:"donut-slices",makeElements:data=>data.sliceStrings.map(((s,i)=>{let t=B(s,"donut-path",data.colors[i],"none",data.strokeWidth);return t.style.transition="transform .3s;",t})),animateElements(t){return this.store.map(((e,i)=>at(e,t.sliceStrings[i])))}},pieSlices:{layerClass:"pie-slices",makeElements:data=>data.sliceStrings.map(((s,i)=>{let t=B(s,"pie-path","none",data.colors[i]);return t.style.transition="transform .3s;",t})),animateElements(t){return this.store.map(((e,i)=>at(e,t.sliceStrings[i])))}},percentageBars:{layerClass:"percentage-bars",makeElements(data){return data.xPositions.map(((t,i)=>{let e=function(t,e,n,r,o=2,l="none"){return I("rect",{className:"percentage-bar",x:t,y:e,width:n,height:r,fill:l,styles:{stroke:z(l,-25),"stroke-dasharray":`0, ${r+n}, ${n}, ${r}`,"stroke-width":o}})}(t,0,data.widths[i],this.constants.barHeight,this.constants.barDepth,data.colors[i]);return e}))},animateElements(t){if(t)return[]}},yAxis:{layerClass:"y axis",makeElements(data){return data.positions.map(((t,i)=>function(t,label,e,n={}){P(t)||(t=0),n.pos||(n.pos="left"),n.offset||(n.offset=0),n.mode||(n.mode="span"),n.stroke||(n.stroke=F),n.className||(n.className="");let r=-6,o="span"===n.mode?e+6:0;return"tick"===n.mode&&"right"===n.pos&&(r=e+6,o=e),r+=n.offset,o+=n.offset,_(t,label,r,o,{stroke:n.stroke,className:n.className,lineType:n.lineType,shortenNumbers:n.shortenNumbers})}(t,data.labels[i],this.constants.width,{mode:this.constants.mode,pos:this.constants.pos,shortenNumbers:this.constants.shortenNumbers})))},animateElements(t){let e=t.positions,n=t.labels,r=this.oldData.positions,o=this.oldData.labels;return[r,e]=$(r,e),[o,n]=$(o,n),this.render({positions:r,labels:n}),this.store.map(((line,i)=>it(line,e[i],r[i])))}},xAxis:{layerClass:"x axis",makeElements(data){return data.positions.map(((t,i)=>J(t,data.calcLabels[i],this.constants.height,{mode:this.constants.mode,pos:this.constants.pos})))},animateElements(t){let e=t.positions,n=t.calcLabels,r=this.oldData.positions,o=this.oldData.calcLabels;return[r,e]=$(r,e),[o,n]=$(o,n),this.render({positions:r,calcLabels:n}),this.store.map(((line,i)=>function(t,e,n){return st(t,[n,0],[e,0],tt)}(line,e[i],r[i])))}},yMarkers:{layerClass:"y-markers",makeElements(data){return data.map((t=>function(t,label,e,n={}){n.labelPos||(n.labelPos="right");let r=I("text",{className:"chart-label",x:"left"===n.labelPos?4:e-T(label,5)-4,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:label+""}),line=_(t,"",0,e,{stroke:n.stroke||F,className:n.className||"",lineType:n.lineType});return line.appendChild(r),line}(t.position,t.label,this.constants.width,{labelPos:t.options.labelPos,mode:"span",lineType:"dashed"})))},animateElements(t){[this.oldData,t]=$(this.oldData,t);let e=t.map((t=>t.position)),n=t.map((t=>t.label)),r=t.map((t=>t.options)),o=this.oldData.map((t=>t.position));return this.render(o.map(((t,i)=>({position:o[i],label:n[i],options:r[i]})))),this.store.map(((line,i)=>it(line,e[i],o[i])))}},yRegions:{layerClass:"y-regions",makeElements(data){return data.map((t=>function(t,e,n,label,r={}){let o=t-e,rect=I("rect",{className:"bar mini",styles:{fill:"rgba(228, 234, 239, 0.49)",stroke:F,"stroke-dasharray":`${n}, ${o}`},x:0,y:0,width:n,height:o});r.labelPos||(r.labelPos="right");let l=I("text",{className:"chart-label",x:"left"===r.labelPos?4:n-T(label+"",4.5)-4,y:0,dy:"-5px","font-size":"10px","text-anchor":"start",innerHTML:label+""}),h=I("g",{transform:`translate(0, ${e})`});return h.appendChild(rect),h.appendChild(l),h}(t.startPos,t.endPos,this.constants.width,t.label,{labelPos:t.options.labelPos})))},animateElements(t){[this.oldData,t]=$(this.oldData,t);let e=t.map((t=>t.endPos)),n=t.map((t=>t.label)),r=t.map((t=>t.startPos)),o=t.map((t=>t.options)),l=this.oldData.map((t=>t.endPos)),h=this.oldData.map((t=>t.startPos));this.render(l.map(((t,i)=>({startPos:h[i],endPos:l[i],label:n[i],options:o[i]}))));let d=[];return this.store.map(((t,i)=>{d=d.concat(function(t,e,n,r){let o=e-n,rect=t.childNodes[0],l=rect.getAttribute("width");return[[rect,{height:o,"stroke-dasharray":`${l}, ${o}`},tt,et],st(t,[0,r],[0,n],tt)]}(t,r[i],e[i],l[i]))})),d}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements(data){let{index:t,colWidth:e,rowHeight:n,squareSize:r,radius:o,xTranslate:l}=this.constants,h=l,d=0;return this.serializedSubDomains=[],data.cols.map(((l,c)=>{1===c&&this.labels.push(X("domain-name",h,-12,vt(t,!0).toUpperCase(),{fontSize:9})),l.map(((t,i)=>{if(t.fill){let data={"data-date":t.yyyyMmDd,"data-value":t.dataValue,"data-day":i},e=G("day",h,d,r,o,t.fill,data);this.serializedSubDomains.push(e)}d+=n})),d=0,h+=e})),this.serializedSubDomains},animateElements(t){if(t)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements(data){let t=this.constants;return this.unitType="bar",this.units=data.yPositions.map(((e,n)=>function(t,e,n,r,label="",o=0,l=0,meta={}){let[h,d]=C(e,meta.zeroLine);d-=l,0===h&&(h=meta.minHeight,d-=meta.minHeight),P(t)||(t=0),P(d)||(d=0),P(h,!0)||(h=0),P(n,!0)||(n=0);let rect=I("rect",{className:"bar mini",style:`fill: ${r}`,"data-point-index":o,x:t,y:d,width:n,height:h});if((label+="")||label.length){rect.setAttribute("y",0),rect.setAttribute("x",0);let text=I("text",{className:"data-point-value",x:n/2,y:0,dy:"-5px","font-size":"10px","text-anchor":"middle",innerHTML:label}),e=I("g",{"data-point-index":o,transform:`translate(${t}, ${d})`});return e.appendChild(rect),e.appendChild(text),e}return rect}(data.xPositions[n],e,data.barWidth,t.color,data.labels[n],n,data.offsets[n],{zeroLine:data.zeroLine,barsWidth:data.barsWidth,minHeight:t.minHeight}))),this.units},animateElements(t){let e=t.xPositions,n=t.yPositions,r=t.offsets,o=t.labels,l=this.oldData.xPositions,h=this.oldData.yPositions,d=this.oldData.offsets,c=this.oldData.labels;[l,e]=$(l,e),[h,n]=$(h,n),[d,r]=$(d,r),[c,o]=$(c,o),this.render({xPositions:l,yPositions:h,offsets:d,labels:o,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});let m=[];return this.store.map(((o,i)=>{m=m.concat(function(t,e,n,r,o=0,meta={}){let[l,h]=C(n,meta.zeroLine);if(h-=o,"rect"!==t.nodeName){let n=[t.childNodes[0],{width:r,height:l},Z,et],o=t.getAttribute("transform").split("(")[1].slice(0,-1);return[n,st(t,o,[e,h],tt)]}return[[t,{width:r,height:l,x:e,y:h},Z,et]]}(o,e[i],n[i],t.barWidth,r[i],{zeroLine:t.zeroLine}))})),m}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements(data){let t=this.constants;return this.unitType="dot",this.paths={},t.hideLine||(this.paths=function(t,e,n,r={},meta={}){let o=e.map(((e,i)=>t[i]+","+e)).join("L");r.spline&&(o=S(t,e));let path=B("M"+o,"line-graph-path",n);if(r.heatline){let t=U(meta.svgDefs,n);path.style.stroke=`url(#${t})`}let l={path:path};if(r.regionFill){let e=U(meta.svgDefs,n,!0),r=`M${t[0]},${meta.zeroLine}L`+o+`L${t.slice(-1)[0]},${meta.zeroLine}`;l.region=B(r,"region-fill","none",`url(#${e})`)}return l}(data.xPositions,data.yPositions,t.color,{heatline:t.heatline,regionFill:t.regionFill,spline:t.spline},{svgDefs:t.svgDefs,zeroLine:data.zeroLine})),this.units=[],t.hideDots||(this.units=data.yPositions.map(((e,n)=>function(t,e,n,r,label="",o=0){let l=I("circle",{style:`fill: ${r}`,"data-point-index":o,cx:t,cy:e,r:n});if((label+="")||label.length){l.setAttribute("cy",0),l.setAttribute("cx",0);let text=I("text",{className:"data-point-value",x:0,y:0,dy:-5-n+"px","font-size":"10px","text-anchor":"middle",innerHTML:label}),r=I("g",{"data-point-index":o,transform:`translate(${t}, ${e})`});return r.appendChild(l),r.appendChild(text),r}return l}(data.xPositions[n],e,data.radius,t.color,t.valuesOverPoints?data.values[n]:"",n)))),Object.values(this.paths).concat(this.units)},animateElements(t){let e=t.xPositions,n=t.yPositions,r=t.values,o=this.oldData.xPositions,l=this.oldData.yPositions,h=this.oldData.values;[o,e]=$(o,e),[l,n]=$(l,n),[h,r]=$(h,r),this.render({xPositions:o,yPositions:l,values:r,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});let d=[];return Object.keys(this.paths).length&&(d=d.concat(function(t,e,n,r,o){let l=[],h=n.map(((t,i)=>e[i]+","+t)).join("L");o&&(h=S(e,n));const d=[t.path,{d:"M"+h},350,et];if(l.push(d),t.region){let n=`${e[0]},${r}L`,o=`L${e.slice(-1)[0]}, ${r}`;const d=[t.region,{d:"M"+n+h+o},350,et];l.push(d)}return l}(this.paths,e,n,t.zeroLine,this.constants.spline))),this.units.length&&this.units.map(((t,i)=>{d=d.concat(function(t,e,n){if("circle"!==t.nodeName){let r=t.getAttribute("transform").split("(")[1].slice(0,-1);return[st(t,r,[e,n],tt)]}return[[t,{cx:e,cy:n},Z,et]]}(t,e[i],n[i]))})),d}}};function Mt(t,e,n){let r=Object.keys(Tt).filter((e=>t.includes(e))),o=Tt[r[0]];return Object.assign(o,{constants:e,getData:n}),new Lt(o)}function Pt(t){if(0===t)return[0,0];if(isNaN(t))return{mantissa:-6755399441055744,exponent:972};var e=t>0?1:-1;if(!isFinite(t))return{mantissa:4503599627370496*e,exponent:972};t=Math.abs(t);var n=Math.floor(Math.log10(t));return[e*(t/Math.pow(10,n)),n]}function Dt(t,e=0){let[n,r]=Pt(t),o=e?e/Math.pow(10,r):0;n=n.toFixed(6);let l=function(t,e=0){let n=Math.ceil(t),r=Math.floor(e),o=n-r,l=o,h=1;o>5&&(o%2!=0&&(n++,o=n-r),l=o/2,h=2),o<=2&&(l=4,h=o/l),0===o&&(l=5,h=1);let d=[];for(var i=0;i<=l;i++)d.push(r+h*i);return d}(n,o);return l=l.map((t=>t*Math.pow(10,r))),l}function Ct(t){return t[1]-t[0]}function $t(t,e){return k(e.zeroLine-t*e.scaleMultiplier)}const Nt=12,St=Nt;class Ot extends ht{constructor(t,e){super(t,e),this.barOptions=e.barOptions||{},this.lineOptions=e.lineOptions||{},this.type=e.type||"line",this.init=1,this.setup()}setMeasures(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}configure(t){super.configure(t),t.axisOptions=t.axisOptions||{},t.tooltipOptions=t.tooltipOptions||{},this.config.xAxisMode=t.axisOptions.xAxisMode||"span",this.config.yAxisMode=t.axisOptions.yAxisMode||"span",this.config.xIsSeries=t.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=t.axisOptions.shortenYAxisNumbers||0,this.config.formatTooltipX=t.tooltipOptions.formatTooltipX,this.config.formatTooltipY=t.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=t.valuesOverPoints}prepareData(data=this.data){return function(data,t){data.labels=data.labels||[];let e=data.labels.length,n=data.datasets,r=new Array(e).fill(0);return n||(n=[{values:r}]),n.map((n=>{if(n.values){let t=n.values;t=t.map((t=>isNaN(t)?0:t)),t=t.length>e?t.slice(0,e):L(t,e-t.length,0),n.values=t}else n.values=r;n.chartType||(f.includes(t),n.chartType=t)})),data.yRegions&&data.yRegions.map((t=>{t.end<t.start&&([t.start,t.end]=[t.end,t.start])})),data}(data,this.type)}prepareFirstData(data=this.data){return function(t){let e=t.labels.length,n=new Array(e).fill(0),r={labels:t.labels.slice(0,-1),datasets:t.datasets.map((t=>({name:"",values:n.slice(0,-1),chartType:t.chartType})))};return t.yMarkers&&(r.yMarkers=[{value:0,label:""}]),t.yRegions&&(r.yRegions=[{start:0,end:0,label:""}]),r}(data)}calc(t=!1){this.calcXPositions(),t||this.calcYAxisParameters(this.getAllYValues(),"line"===this.type),this.makeDataByIndex()}calcXPositions(){let s=this.state,t=this.data.labels;s.datasetLength=t.length,s.unitWidth=this.width/s.datasetLength,s.xOffset=s.unitWidth/2,s.xAxis={labels:t,positions:t.map(((t,i)=>k(s.xOffset+i*s.unitWidth)))}}calcYAxisParameters(t,e="false"){const n=function(t,e=!1){let n=Math.max(...t),r=Math.min(...t),o=0,l=[];function h(t,e){let n=Dt(t),r=n[1]-n[0],o=0;for(var i=1;o<e;i++)o+=r,n.unshift(-1*o);return n}if(n>=0&&r>=0)o=Pt(n)[1],l=e?Dt(n,r):Dt(n);else if(n>0&&r<0){let t=Math.abs(r);n>=t?(o=Pt(n)[1],l=h(n,t)):(o=Pt(t)[1],l=h(t,n).reverse().map((t=>-1*t)))}else if(n<=0&&r<=0){let t=Math.abs(r),h=Math.abs(n);o=Pt(t)[1],l=e?Dt(t,h):Dt(t),l=l.reverse().map((t=>-1*t))}return l}(t,e),r=this.height/((o=n)[o.length-1]-o[0]);var o;const l=Ct(n)*r,h=this.height-function(t){let e,n=Ct(t);e=t.indexOf(0)>=0?t.indexOf(0):t[0]>0?-1*t[0]/n:-1*t[t.length-1]/n+(t.length-1);return e}(n)*l;this.state.yAxis={labels:n,positions:n.map((t=>h-t*r)),scaleMultiplier:r,zeroLine:h},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}calcDatasetPoints(){let s=this.state,t=t=>t.map((t=>$t(t,s.yAxis)));s.datasets=this.data.datasets.map(((e,i)=>{let n=e.values,r=e.cumulativeYs||[];return{name:e.name&&e.name.replace(/<|>|&/g,(t=>"&"==t?"&amp;":"<"==t?"&lt;":"&gt;")),index:i,chartType:e.chartType,values:n,yPositions:t(n),cumulativeYs:r,cumulativeYPos:t(r)}}))}calcYExtremes(){let s=this.state;this.barOptions.stacked?s.yExtremes=s.datasets[s.datasets.length-1].cumulativeYPos:(s.yExtremes=new Array(s.datasetLength).fill(9999),s.datasets.map((t=>{t.yPositions.map(((t,e)=>{t<s.yExtremes[e]&&(s.yExtremes[e]=t)}))})))}calcYRegions(){let s=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map((t=>(t.position=$t(t.value,s.yAxis),t.options||(t.options={}),t)))),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map((t=>(t.startPos=$t(t.start,s.yAxis),t.endPos=$t(t.end,s.yAxis),t.options||(t.options={}),t))))}getAllYValues(){let t="values";if(this.barOptions.stacked){t="cumulativeYs";let e=new Array(this.state.datasetLength).fill(0);this.data.datasets.map(((n,i)=>{let r=this.data.datasets[i].values;n[t]=e=e.map(((t,i)=>t+r[i]))}))}let e=this.data.datasets.map((e=>e[t]));return this.data.yMarkers&&e.push(this.data.yMarkers.map((t=>t.value))),this.data.yRegions&&this.data.yRegions.map((t=>{e.push([t.end,t.start])})),[].concat(...e)}setupComponents(){let t=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){let s=this.state;return s.xAxis.calcLabels=function(t,e=[],n=!0){let r=t/e.length;r<=0&&(r=1);let o,l=r/7;if(n){let t=Math.max(...e.map((label=>label.length)));o=Math.ceil(t/l)}return e.map(((label,i)=>((label+="").length>l&&(n?i%o!=0&&(label=""):label=l-3>0?label.slice(0,l-3)+" ...":label.slice(0,l)+".."),label)))}(this.width,s.xAxis.labels,this.config.xIsSeries),s.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],e=this.state.datasets.filter((t=>"bar"===t.chartType)),n=this.state.datasets.filter((t=>"line"===t.chartType)),r=e.map((t=>{let n=t.index;return["barGraph-"+t.index,{index:n,color:this.colors[n],stacked:this.barOptions.stacked,valuesOverPoints:this.config.valuesOverPoints,minHeight:0*this.height},function(){let s=this.state,t=s.datasets[n],r=this.barOptions.stacked,o=this.barOptions.spaceRatio||.5,l=s.unitWidth*(1-o),h=l/(r?1:e.length),d=s.xAxis.positions.map((t=>t-l/2));r||(d=d.map((p=>p+h*n)));let c=new Array(s.datasetLength).fill("");this.config.valuesOverPoints&&(c=r&&t.index===s.datasets.length-1?t.cumulativeYs:t.values);let m=new Array(s.datasetLength).fill(0);return r&&(m=t.yPositions.map(((e,n)=>e-t.cumulativeYPos[n]))),{xPositions:d,yPositions:t.yPositions,offsets:m,labels:c,zeroLine:s.yAxis.zeroLine,barsWidth:l,barWidth:h}}.bind(this)]})),o=n.map((t=>{let e=t.index;return["lineGraph-"+t.index,{index:e,color:this.colors[e],svgDefs:this.svgDefs,heatline:this.lineOptions.heatline,regionFill:this.lineOptions.regionFill,spline:this.lineOptions.spline,hideDots:this.lineOptions.hideDots,hideLine:this.lineOptions.hideLine,valuesOverPoints:this.config.valuesOverPoints},function(){let s=this.state,t=s.datasets[e],n=s.yAxis.positions[0]<s.yAxis.zeroLine?s.yAxis.positions[0]:s.yAxis.zeroLine;return{xPositions:s.xAxis.positions,yPositions:t.yPositions,values:t.values,zeroLine:n,radius:this.lineOptions.dotSize||4}}.bind(this)]})),l=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];t=t.concat(r,o,l);let h=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(t.filter((t=>!h.includes(t[0])||this.state[t[0]])).map((t=>{let component=Mt(...t);return(t[0].includes("lineGraph")||t[0].includes("barGraph"))&&this.dataUnitComponents.push(component),[t[0],component]})))}makeDataByIndex(){this.dataByIndex={};let s=this.state,t=this.config.formatTooltipX,e=this.config.formatTooltipY;s.xAxis.labels.map(((label,n)=>{let r=this.state.datasets.map(((t,i)=>{let r=t.values[n];return{title:t.name,value:r,yPos:t.yPositions[n],color:this.colors[i],formatted:e?e(r):r}}));this.dataByIndex[n]={label:label,formattedLabel:t?t(label):label,xPos:s.xAxis.positions[n],values:r,yExtreme:s.yExtremes[n]}}))}bindTooltip(){this.container.addEventListener("mousemove",(t=>{let e=this.measures,n=o(this.container),r=t.pageX-n.left-d(e),l=t.pageY-n.top;l<this.height+h(e)&&l>h(e)?this.mapTooltipXPosition(r):this.tip.hideTip()}))}mapTooltipXPosition(t){let s=this.state;if(!s.yExtremes)return;let e=function(t,e,n=!1){let r=e.reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e}),[]);return n?e.indexOf(r):r}(t,s.xAxis.positions,!0);if(e>=0){let t=this.dataByIndex[e];this.tip.setValues(t.xPos+this.tip.offset.x,t.yExtreme+this.tip.offset.y,{name:t.formattedLabel,value:""},t.values,e),this.tip.showTip()}}renderLegend(){let s=this.data;s.datasets.length>1&&(this.legendArea.textContent="",s.datasets.map(((t,i)=>{let rect=function(t,e,n,r="none",label,o=!1){label=o?N(label,15):label;let l={className:"legend-bar",x:0,y:0,width:n,height:"2px",fill:r},text=I("text",{className:"legend-dataset-text",x:0,y:0,dy:"20px","font-size":"12px","text-anchor":"start",fill:R,innerHTML:label}),h=I("g",{transform:`translate(${t}, ${e})`});return h.appendChild(I("rect",l)),h.appendChild(text),h}(100*i,"0",100,this.colors[i],t.name,this.config.truncateLegends);this.legendArea.appendChild(rect)})))}makeOverlay(){this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach((g=>{let t=g.overlay;t.parentNode.removeChild(t)})),this.overlayGuides=this.dataUnitComponents.map((t=>({type:t.unitType,overlay:void 0,units:t.units}))),void 0===this.state.currentIndex&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map((t=>{let e=t.units[this.state.currentIndex];t.overlay=K[t.type](e),this.drawArea.appendChild(t.overlay)})))}updateOverlayGuides(){this.overlayGuides&&this.overlayGuides.forEach((g=>{let t=g.overlay;t.parentNode.removeChild(t)}))}bindOverlay(){this.parent.addEventListener("data-select",(()=>{this.updateOverlay()}))}bindUnits(){this.dataUnitComponents.map((t=>{t.units.map((t=>{t.addEventListener("click",(()=>{let e=t.getAttribute("data-point-index");this.setCurrentDataPoint(e)}))}))})),this.tip.container.addEventListener("click",(()=>{let t=this.tip.container.getAttribute("data-point-index");this.setCurrentDataPoint(t)}))}updateOverlay(){this.overlayGuides.map((t=>{let e=t.units[this.state.currentIndex];Q[t.type](e,t.overlay)}))}onLeftArrow(){this.setCurrentDataPoint(this.state.currentIndex-1)}onRightArrow(){this.setCurrentDataPoint(this.state.currentIndex+1)}getDataPoint(t=this.state.currentIndex){let s=this.state;return{index:t,label:s.xAxis.labels[t],values:s.datasets.map((e=>e.values[t]))}}setCurrentDataPoint(t){let s=this.state;(t=parseInt(t))<0&&(t=0),t>=s.xAxis.labels.length&&(t=s.xAxis.labels.length-1),t!==s.currentIndex&&(s.currentIndex=t,function(t,e,n){var r=document.createEvent("HTMLEvents");for(var o in r.initEvent(e,!0,!0),n)r[o]=n[o];t.dispatchEvent(r)}(this.parent,"data-select",this.getDataPoint()))}addDataPoint(label,t,e=this.state.datasetLength){super.addDataPoint(label,t,e),this.data.labels.splice(e,0,label),this.data.datasets.map(((n,i)=>{n.values.splice(e,0,t[i])})),this.update(this.data)}removeDataPoint(t=this.state.datasetLength-1){this.data.labels.length<=1||(super.removeDataPoint(t),this.data.labels.splice(t,1),this.data.datasets.map((e=>{e.values.splice(t,1)})),this.update(this.data))}updateDataset(t,e=0){this.data.datasets[e].values=t,this.update(this.data)}updateDatasets(t){this.data.datasets.map(((e,i)=>{t[i]&&(e.values=t[i])})),this.update(this.data)}}const Et={bar:Ot,line:Ot,percentage:class extends ct{constructor(t,e){super(t,e),this.type="percentage",this.setup()}setMeasures(t){let e=this.measures;this.barOptions=t.barOptions||{};let b=this.barOptions;b.height=b.height||20,b.depth=b.depth||2,e.paddings.right=30,e.legendHeight=60,e.baseHeight=8*(b.height+.5*b.depth)}setupComponents(){let s=this.state,t=[["percentageBars",{barHeight:this.barOptions.height,barDepth:this.barOptions.depth},function(){return{xPositions:s.xPositions,widths:s.widths,colors:this.colors}}.bind(this)]];this.components=new Map(t.map((t=>{let component=Mt(...t);return[t[0],component]})))}calc(){super.calc();let s=this.state;s.xPositions=[],s.widths=[];let t=0;s.sliceTotals.map((e=>{let n=this.width*e/s.grandTotal;s.widths.push(n),s.xPositions.push(t),t+=n}))}makeDataByIndex(){}bindTooltip(){let s=this.state;this.container.addEventListener("mousemove",(t=>{let e=this.components.get("percentageBars").store,n=t.target;if(e.includes(n)){let i=e.indexOf(n),t=o(this.container),r=o(n),l=r.left-t.left+parseInt(n.getAttribute("width"))/2,h=r.top-t.top,title=(this.formattedLabels&&this.formattedLabels.length>0?this.formattedLabels[i]:this.state.labels[i])+": ",d=s.sliceTotals[i]/s.grandTotal;this.tip.setValues(l,h,{name:title,value:(100*d).toFixed(1)+"%"}),this.tip.showTip()}}))}},heatmap:class extends ht{constructor(t,e){super(t,e),this.type="heatmap",this.countLabel=e.countLabel||"";let n=["Sunday","Monday"],r=n.includes(e.startSubDomain)?e.startSubDomain:"Sunday";this.startSubDomainIndex=n.indexOf(r),this.setup()}setMeasures(t){let e=this.measures;this.discreteDomains=0===t.discreteDomains?0:1,e.paddings.top=36,e.paddings.bottom=0,e.legendHeight=24,e.baseHeight=84+c(e);let n=this.data,r=this.discreteDomains?12:0;this.independentWidth=(bt(n.start,n.end)+r)*Nt+m(e)}updateWidth(){let t=this.discreteDomains?12:0,e=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=(e+t)*Nt+m(this.measures)}prepareData(data=this.data){if(data.start&&data.end&&data.start>data.end)throw new Error("Start date cannot be greater than end date.");if(data.start||(data.start=new Date,data.start.setFullYear(data.start.getFullYear()-1)),data.end||(data.end=new Date),data.dataPoints=data.dataPoints||{},parseInt(Object.keys(data.dataPoints)[0])>1e5){let t={};Object.keys(data.dataPoints).forEach((e=>{let n=new Date(e*pt);t[ft(n)]=data.dataPoints[e]})),data.dataPoints=t}return data}calc(){let s=this.state;s.start=yt(this.data.start),s.end=yt(this.data.end),s.firstWeekStart=yt(s.start),s.noOfWeeks=bt(s.start,s.end),s.distribution=function(t,e){let n=Math.max(...t),r=1/(e-1),o=[];for(var i=0;i<e;i++){let t=n*(r*i);o.push(t)}return o}(Object.values(this.data.dataPoints),5),s.domainConfigs=this.getDomains()}setupComponents(){let s=this.state,t=this.discreteDomains?0:1,e=s.domainConfigs.map(((e,i)=>["heatDomain",{index:e.index,colWidth:Nt,rowHeight:St,squareSize:y,radius:this.rawChartArgs.radius||0,xTranslate:s.domainConfigs.filter(((t,e)=>e<i)).map((e=>e.cols.length-t)).reduce(((a,b)=>a+b),0)*Nt},function(){return s.domainConfigs[i]}.bind(this)]));this.components=new Map(e.map(((t,i)=>{let component=Mt(...t);return[t[0]+"-"+i,component]})));let n=0;mt.forEach(((t,i)=>{if([1,3,5].includes(i)){let e=X("subdomain-name",-6,n,t,{fontSize:y,dy:8,textAnchor:"end"});this.drawArea.appendChild(e)}n+=St}))}update(data){data||console.error("No data to update."),this.data=this.prepareData(data),this.draw(),this.bindTooltip()}bindTooltip(){this.container.addEventListener("mousemove",(t=>{this.components.forEach((e=>{let n=e.store,r=t.target;if(n.includes(r)){let e=r.getAttribute("data-value"),n=r.getAttribute("data-date").split("-"),o=vt(parseInt(n[1])-1,!0),l=this.container.getBoundingClientRect(),h=r.getBoundingClientRect(),d=parseInt(t.target.getAttribute("width")),c=h.left-l.left+d/2,m=h.top-l.top,f=e+" "+this.countLabel,y=" on "+o+" "+n[0]+", "+n[2];this.tip.setValues(c,m,{name:y,value:f,valueFirst:1},[]),this.tip.showTip()}}))}))}renderLegend(){this.legendArea.textContent="";let t=0,e=this.rawChartArgs.radius||0,n=X("subdomain-name",t,12,"Less",{fontSize:11,dy:9});t=30,this.legendArea.appendChild(n),this.colors.slice(0,5).map(((n,i)=>{const r=G("heatmap-legend-unit",t+15*i,12,y,e,n);this.legendArea.appendChild(r)}));let r=X("subdomain-name",t+75+3,12,"More",{fontSize:11,dy:9});this.legendArea.appendChild(r)}getDomains(){let s=this.state;const[t,e]=[s.start.getMonth(),s.start.getFullYear()],[n,r]=[s.end.getMonth(),s.end.getFullYear()],o=n-t+1+12*(r-e);let l=[],h=yt(s.start);for(var i=0;i<o;i++){let t=s.end;if(!xt(h,s.end)){let[e,n]=[h.getMonth(),h.getFullYear()];t=wt(e,n)}l.push(this.getDomainConfig(h,t)),kt(t,1),h=t}return l}getDomainConfig(t,e=""){let[n,r]=[t.getMonth(),t.getFullYear()],o=At(t),l={index:n,cols:[]};kt(e=yt(e)||wt(n,r),1);let col,h=bt(o,e),d=[];for(var i=0;i<h;i++)col=this.getCol(o,n),d.push(col),o=new Date(col[6].yyyyMmDd),kt(o,1);return void 0!==col[6].dataValue&&(kt(o,1),d.push(this.getCol(o,n,!0))),l.cols=d,l}getCol(t,e,n=!1){let s=this.state,r=yt(t),col=[];for(var i=0;i<7;i++,kt(r,1)){let t={},o=r>=s.start&&r<=s.end;n||r.getMonth()!==e||!o?t.yyyyMmDd=ft(r):t=this.getSubDomainConfig(r),col.push(t)}return col}getSubDomainConfig(t){let e=ft(t),n=this.data.dataPoints[e];var r,o;return{yyyyMmDd:e,dataValue:n||0,fill:this.colors[(r=n,o=this.state.distribution,o.filter((t=>t<r)).length)]}}},pie:class extends ct{constructor(t,e){super(t,e),this.type="pie",this.initTimeout=0,this.init=1,this.setup()}configure(t){super.configure(t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.clockWise=t.clockWise||!1}calc(){super.calc();let s=this.state;this.radius=this.height>this.width?this.center.x:this.center.y;const{radius:t,clockWise:e}=this,n=s.slicesProperties||[];s.sliceStrings=[],s.slicesProperties=[];let r=180-this.config.startAngle;s.sliceTotals.map(((o,i)=>{const l=r,h=o/s.grandTotal*360,d=h>180?1:0,c=e?-h:h,m=r+=c,f=M(l,t),y=M(m,t),x=this.init&&n[i];let v,w;this.init?(v=x?x.startPosition:f,w=x?x.endPosition:f):(v=f,w=y);const A=360===h?function(t,e,n,r,o=1,l=0){let[h,d]=[n.x+t.x,n.y+t.y],[c,m,f]=[n.x+e.x,2*n.y,n.y+e.y];return`M${n.x} ${n.y}\n\t\tL${h} ${d}\n\t\tA ${r} ${r} 0 ${l} ${o?1:0}\n\t\t${c} ${m} z\n\t\tL${h} ${m}\n\t\tA ${r} ${r} 0 ${l} ${o?1:0}\n\t\t${c} ${f} z`}(v,w,this.center,this.radius,e,d):function(t,e,n,r,o=1,l=0){let[h,d]=[n.x+t.x,n.y+t.y],[c,m]=[n.x+e.x,n.y+e.y];return`M${n.x} ${n.y}\n\t\tL${h} ${d}\n\t\tA ${r} ${r} 0 ${l} ${o?1:0}\n\t\t${c} ${m} z`}(v,w,this.center,this.radius,e,d);s.sliceStrings.push(A),s.slicesProperties.push({startPosition:f,endPosition:y,value:o,total:s.grandTotal,startAngle:l,endAngle:m,angle:c})})),this.init=0}setupComponents(){let s=this.state,t=[["pieSlices",{},function(){return{sliceStrings:s.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(t.map((t=>{let component=Mt(...t);return[t[0],component]})))}calTranslateByAngle(t){const{radius:e,hoverRadio:n}=this,r=M(t.startAngle+t.angle/2,e);return`translate3d(${r.x*n}px,${r.y*n}px,0)`}hoverSlice(path,i,t,e){if(!path)return;const n=this.colors[i];if(t){ot(path,this.calTranslateByAngle(this.state.slicesProperties[i])),path.style.fill=z(n,50);let t=o(this.svg),r=e.pageX-t.left+10,l=e.pageY-t.top-10,title=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[i]:this.state.labels[i])+": ",h=(100*this.state.sliceTotals[i]/this.state.grandTotal).toFixed(1);this.tip.setValues(r,l,{name:title,value:h+"%"}),this.tip.showTip()}else ot(path,"translate3d(0,0,0)"),this.tip.hideTip(),path.style.fill=n}bindTooltip(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}mouseMove(t){const e=t.target;let n=this.components.get("pieSlices").store,r=this.curActiveSliceIndex,o=this.curActiveSlice;if(n.includes(e)){let i=n.indexOf(e);this.hoverSlice(o,r,!1),this.curActiveSlice=e,this.curActiveSliceIndex=i,this.hoverSlice(e,i,!0,t)}else this.mouseLeave()}mouseLeave(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}},donut:class extends ct{constructor(t,e){super(t,e),this.type="donut",this.initTimeout=0,this.init=1,this.setup()}configure(t){super.configure(t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.clockWise=t.clockWise||!1,this.strokeWidth=t.strokeWidth||30}calc(){super.calc();let s=this.state;this.radius=this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2;const{radius:t,clockWise:e}=this,n=s.slicesProperties||[];s.sliceStrings=[],s.slicesProperties=[];let r=180-this.config.startAngle;s.sliceTotals.map(((o,i)=>{const l=r,h=o/s.grandTotal*360,d=h>180?1:0,c=e?-h:h,m=r+=c,f=M(l,t),y=M(m,t),x=this.init&&n[i];let v,w;this.init?(v=x?x.startPosition:f,w=x?x.endPosition:f):(v=f,w=y);const A=360===h?function(t,e,n,r,o=1,l=0){let[h,d]=[n.x+t.x,n.y+t.y],[c,m,f]=[n.x+e.x,2*r+d,n.y+t.y];return`M${h} ${d}\n\t\tA ${r} ${r} 0 ${l} ${o?1:0}\n\t\t${c} ${m}\n\t\tM${h} ${m}\n\t\tA ${r} ${r} 0 ${l} ${o?1:0}\n\t\t${c} ${f}`}(v,w,this.center,this.radius,this.clockWise,d):function(t,e,n,r,o=1,l=0){let[h,d]=[n.x+t.x,n.y+t.y],[c,m]=[n.x+e.x,n.y+e.y];return`M${h} ${d}\n\t\tA ${r} ${r} 0 ${l} ${o?1:0}\n\t\t${c} ${m}`}(v,w,this.center,this.radius,this.clockWise,d);s.sliceStrings.push(A),s.slicesProperties.push({startPosition:f,endPosition:y,value:o,total:s.grandTotal,startAngle:l,endAngle:m,angle:c})})),this.init=0}setupComponents(){let s=this.state,t=[["donutSlices",{},function(){return{sliceStrings:s.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(t.map((t=>{let component=Mt(...t);return[t[0],component]})))}calTranslateByAngle(t){const{radius:e,hoverRadio:n}=this,r=M(t.startAngle+t.angle/2,e);return`translate3d(${r.x*n}px,${r.y*n}px,0)`}hoverSlice(path,i,t,e){if(!path)return;const n=this.colors[i];if(t){ot(path,this.calTranslateByAngle(this.state.slicesProperties[i])),path.style.stroke=z(n,50);let t=o(this.svg),r=e.pageX-t.left+10,l=e.pageY-t.top-10,title=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[i]:this.state.labels[i])+": ",h=(100*this.state.sliceTotals[i]/this.state.grandTotal).toFixed(1);this.tip.setValues(r,l,{name:title,value:h+"%"}),this.tip.showTip()}else ot(path,"translate3d(0,0,0)"),this.tip.hideTip(),path.style.stroke=n}bindTooltip(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}mouseMove(t){const e=t.target;let n=this.components.get("donutSlices").store,r=this.curActiveSliceIndex,o=this.curActiveSlice;if(n.includes(e)){let i=n.indexOf(e);this.hoverSlice(o,r,!1),this.curActiveSlice=e,this.curActiveSliceIndex=i,this.hoverSlice(e,i,!0,t)}else this.mouseLeave()}mouseLeave(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}};class zt{constructor(t,e){return function(t="line",e,n){return"axis-mixed"===t?(n.type="line",new Ot(e,n)):Et[t]?new Et[t](e,n):void console.error("Undefined chart type: "+t)}(e.type,t,e)}}}}]);